# AWS S3 CLI common operations
```bash
aws s3
aws s3 help
aws s3 ls 
export AWS_CLI_AUTO_PROMPT=on-partial  # Enable auto prompt
env | grep AWS

# remove bucket (remove content before that)
aws s3 rb s3://davidpangsw-s3-example-bucket # fail if non-empty
aws s3 rm s3://davidpangsw-s3-example-bucket/ --recursive
aws s3 rb s3://davidpangsw-s3-example-bucket

# create and list buckets
aws s3api create-bucket --bucket davidpangsw-s3-example --region us-east-1
aws s3api list-buckets

# Query with JMESPath
aws s3api list-buckets --query Buckets
aws s3api list-buckets --query Buckets[].Name
aws s3api list-buckets --query Buckets[].Name --output text
aws s3api list-buckets --query Buckets[].Name --output table #json/text/table/yaml/yaml-stream
aws s3api list-buckets --query "Buckets[?Name=='davidpangsw-s3-example'].Name"
aws s3api list-buckets --query "Buckets[?Name=='davidpangsw-s3-example'].Name"

# Put / List / Get objects
# ListObjectsV2 uses ContinuationToken for pagination, which is a more robust and efficient method for retrieving large object lists compared to the Marker parameter used in ListObjects. ContinuationToken ensures consistent and reliable pagination, especially in scenarios with concurrent object modifications.
aws s3api put-object --bucket davidpangsw-s3-example --key images/hello.txt --content-type plain/txt --body hello.txt
aws s3api list-objects-v2 --bucket davidpangsw-s3-example --query Contents[].Key
aws s3api get-object --bucket davidpangsw-s3-example --key images/hello.txt hello.txt

## Note: s3api is low-level, and doesn't provide options to upload whole folder?
aws s3 sync images/ s3://davidpangsw-aws-example/images/
```


## Examples from AI
```bash
# This script demonstrates basic AWS S3 CLI operations.

# Bucket Operations
aws s3 mb s3://my-bucket-name --region us-east-1  # Make a bucket
aws s3 ls                                         # List all buckets
aws s3 ls s3://my-bucket-name                     # Check if bucket exists
aws s3 rb s3://my-bucket-name                     # Remove an empty bucket
aws s3 rb s3://my-bucket-name --force             # Remove bucket and contents

# Object Operations
aws s3 cp local-file.txt s3://my-bucket-name/     # Upload a file
aws s3 cp local-dir/ s3://my-bucket-name/ --recursive # Upload a directory
aws s3 cp s3://my-bucket-name/file.txt local-file.txt # Download a file
aws s3 cp s3://my-bucket-name/ local-dir/ --recursive # Download a directory
aws s3 sync local-dir/ s3://my-bucket-name/       # Sync local directory to bucket
aws s3 sync s3://my-bucket-name/ local-dir/       # Sync bucket to local directory
aws s3 ls s3://my-bucket-name/path/               # List objects in bucket under path
aws s3 mv s3://my-bucket-name/file.txt s3://my-bucket-name/moved.txt # Move object within bucket
aws s3 rm s3://my-bucket-name/file.txt            # Remove a file

# Access Operations
aws s3 presign s3://my-bucket-name/file.txt --expires-in 3600 # Generate presigned URL for private file
```

```bash
#!/bin/bash

# This script demonstrates basic AWS S3 CLI operations using s3api.

# Bucket Operations
aws s3api create-bucket --bucket my-bucket-name --region us-east-1
aws s3api list-buckets # List all buckets
aws s3api head-bucket --bucket my-bucket-name # Check if bucket exists
aws s3api delete-bucket --bucket my-bucket-name # Remove an empty bucket

# Object Operations
aws s3api put-object --bucket my-bucket-name --key path/to/file.txt --body local-file.txt # Upload a file
aws s3api get-object --bucket my-bucket-name --key path/to/file.txt local-file.txt # Download a file
aws s3api list-objects-v2 --bucket my-bucket-name --prefix path/ # List objects in bucket under path
aws s3api copy-object --copy-source my-source-bucket/path/to/file.txt --bucket my-dest-bucket --key path/to/file.txt
aws s3api delete-object --bucket my-bucket-name --key path/to/file.txt # Remove a file

# Query bucket information using JMES Path
aws s3api list-buckets --query Buckets # Get all bucket details in JSON
aws s3api list-buckets --query Buckets[].Name # Get all bucket names
aws s3api list-buckets --query Buckets[].Name --output text # Bucket names in text
aws s3api list-buckets --query 'Buckets[].{Name: Name, MyDate: CreationDate}' --output table # Bucket names and creation dates in table
aws s3api list-buckets --query 'Buckets[?contains(Name, `example`)].Name' --output yaml # Bucket names containing 'example' in YAML
aws s3api list-buckets --query 'Buckets[].CreationDate' --output text # Creation dates in text
aws s3api list-buckets --query 'Buckets[?CreationDate>`2023-01-01`].Name' --output json # Names of buckets created after 2023-01-01
aws s3api list-buckets --query 'Buckets | length(@)' --output text # Count total buckets
aws s3api list-buckets --query 'Buckets | sort_by(@, &CreationDate) | [0].Name' --output text # Name of the oldest bucket
aws s3api list-buckets --query 'Buckets | sort_by(@, &CreationDate) | [-1].Name' --output yaml # Name of the newest bucket
```